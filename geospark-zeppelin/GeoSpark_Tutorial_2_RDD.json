{"paragraphs":[{"text":"import org.datasyslab.geosparksql.utils._\nimport org.datasyslab.geosparkviz.sql.utils.GeoSparkVizRegistrator\nimport org.datasyslab.geospark.spatialRDD._\nimport org.datasyslab.geospark.enums.{FileDataSplitter, GridType, IndexType}\nimport org.datasyslab.geospark.formatMapper._\nimport org.datasyslab.geospark.spatialOperator._\nimport com.vividsolutions.jts.geom._\n\n// Zeppelin creates and injects sc (SparkContext) and sqlContext (HiveContext or SqlContext)\n// So you don't need create them manually\n\n// Load Long Lat from a CSV file: Area landmark\nval pointrdd = new PointRDD(sc, \"/home/ubuntu/data/arealm.csv\", 0, FileDataSplitter.CSV, true)\n\n// Load WKB format file: USA county\nval polygonrdd_wkb = WkbReader.readToGeometryRDD(sc, \"/home/ubuntu/data/county_small_wkb.tsv\", 0, false, false)\n\n// Load WKT format file: USA county\nval polygonrdd_wkt = WktReader.readToGeometryRDD(sc, \"/home/ubuntu/data/county_small.tsv\", 0, false, false)\n","user":"anonymous","dateUpdated":"2019-11-04T01:36:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.datasyslab.geosparksql.utils._\nimport org.datasyslab.geosparkviz.sql.utils.GeoSparkVizRegistrator\nimport org.datasyslab.geospark.spatialRDD._\nimport org.datasyslab.geospark.enums.{FileDataSplitter, GridType, IndexType}\nimport org.datasyslab.geospark.formatMapper._\nimport org.datasyslab.geospark.spatialOperator._\nimport com.vividsolutions.jts.geom._\npointrdd: org.datasyslab.geospark.spatialRDD.PointRDD = org.datasyslab.geospark.spatialRDD.PointRDD@3800dcb7\npolygonrdd_wkb: org.datasyslab.geospark.spatialRDD.SpatialRDD[com.vividsolutions.jts.geom.Geometry] = org.datasyslab.geospark.spatialRDD.SpatialRDD@151f243c\npolygonrdd_wkt: org.datasyslab.geospark.spatialRDD.SpatialRDD[com.vividsolutions.jts.geom.Geometry] = org.datasyslab.geospark.spatialRDD.SpatialRDD@6360f934\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=119","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=119","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=120","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=120"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572762055480_-1624100583","id":"20191103-062055_1992345549","dateCreated":"2019-11-03T06:20:55+0000","dateStarted":"2019-11-04T01:36:37+0000","dateFinished":"2019-11-04T01:36:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:168240"},{"text":"// Optional: Use DF to manipulate RDD\n// GeoSpark provides an Adapter class\nval pointdf = Adapter.toDf(pointrdd, spark)\npointdf.createOrReplaceTempView(\"area_landmark\")\npointdf.show","user":"anonymous","dateUpdated":"2019-11-04T01:36:38+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|            geometry|\n+--------------------+\n|POINT (-88.331492...|\n|POINT (-88.175933...|\n|POINT (-88.388954...|\n|POINT (-88.221102...|\n|POINT (-88.323995...|\n|POINT (-88.231077...|\n|POINT (-88.349276...|\n|POINT (-88.304259...|\n|POINT (-88.182481...|\n|POINT (-86.955186...|\n|POINT (-87.059169...|\n|POINT (-87.251219...|\n|POINT (-87.534883...|\n|POINT (-87.49702 ...|\n|POINT (-88.280149...|\n|POINT (-88.153618...|\n|POINT (-86.988768...|\n|POINT (-87.586341...|\n|POINT (-87.40708 ...|\n|POINT (-87.43091 ...|\n+--------------------+\nonly showing top 20 rows\n\npointdf: org.apache.spark.sql.DataFrame = [geometry: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=121","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=121","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=122","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=122"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572826583479_-482523213","id":"20191104-001623_1303842514","dateCreated":"2019-11-04T00:16:23+0000","dateStarted":"2019-11-04T01:36:38+0000","dateFinished":"2019-11-04T01:36:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168241"},{"text":"// Optional: Use DF to manipulate RDD\n// GeoSpark provides an Adapter class\nval polygondf_wkb = Adapter.toDf(polygonrdd_wkb, spark)\npolygondf_wkb.createOrReplaceTempView(\"county_wkb\")\npolygondf_wkb.show","user":"anonymous","dateUpdated":"2019-11-04T01:36:39+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---+---+--------+-----+-----------+--------------------+---+---+-----+----+-----+----+----+----------+--------+-----------+------------+\n|            geometry|_c1|_c2|     _c3|  _c4|        _c5|                 _c6|_c7|_c8|  _c9|_c10| _c11|_c12|_c13|      _c14|    _c15|       _c16|        _c17|\n+--------------------+---+---+--------+-----+-----------+--------------------+---+---+-----+----+-----+----+----+----------+--------+-----------+------------+\n|POLYGON ((-97.019...| 31|039|00835841|31039|     Cuming|       Cuming County| 06| H1|G4020|    |     |    |   A|1477895811|10447360|+41.9158651|-096.7885168|\n|POLYGON ((-123.43...| 53|069|01513275|53069|  Wahkiakum|    Wahkiakum County| 06| H1|G4020|    |     |    |   A| 682138871|61658258|+46.2946377|-123.4244583|\n|POLYGON ((-104.56...| 35|011|00933054|35011|    De Baca|      De Baca County| 06| H1|G4020|    |     |    |   A|6015539696|29159492|+34.3592729|-104.3686961|\n|POLYGON ((-96.910...| 31|109|00835876|31109|  Lancaster|    Lancaster County| 06| H1|G4020| 339|30700|    |   A|2169240202|22877180|+40.7835474|-096.6886584|\n|POLYGON ((-98.273...| 31|129|00835886|31129|   Nuckolls|     Nuckolls County| 06| H1|G4020|    |     |    |   A|1489645187| 1718484|+40.1764918|-098.0468422|\n|POLYGON ((-65.910...| 72|085|01804523|72085|Las Piedras|Las Piedras Munic...| 13| H1|G4020| 490|41980|    |   A|  87748363|   32509|+18.1871483|-065.8711890|\n|POLYGON ((-97.129...| 46|099|01265772|46099|  Minnehaha|    Minnehaha County| 06| H1|G4020|    |43620|    |   A|2090540341|17349847|+43.6674723|-096.7957261|\n|POLYGON ((-99.821...| 48|327|01383949|48327|     Menard|       Menard County| 06| H1|G4020|    |     |    |   A|2336245914|  613559|+30.8843655|-099.8539896|\n|POLYGON ((-120.65...| 06|091|00277310|06091|     Sierra|       Sierra County| 06| H1|G4020|    |     |    |   A|2468686374|23299110|+39.5769252|-120.5219926|\n|POLYGON ((-85.239...| 21|053|00516873|21053|    Clinton|      Clinton County| 06| H1|G4020|    |     |    |   A| 510864252|21164150|+36.7288647|-085.1534262|\n|POLYGON ((-83.880...| 39|063|01074044|39063|    Hancock|      Hancock County| 06| H1|G4020| 248|22300|    |   A|1376210232| 5959837|+41.0004711|-083.6660335|\n|POLYGON ((-102.08...| 48|189|01383880|48189|       Hale|         Hale County| 06| H1|G4020|    |38380|    |   A|2602115649|  246678|+34.0684364|-101.8228879|\n|POLYGON ((-85.978...| 01|027|00161539|01027|       Clay|         Clay County| 06| H1|G4020|    |     |    |   A|1564252367| 5284573|+33.2703999|-085.8635254|\n|POLYGON ((-101.62...| 48|011|01383791|48011|  Armstrong|    Armstrong County| 06| H1|G4020| 108|11100|    |   A|2354581764|12219587|+34.9641790|-101.3566363|\n|POLYGON ((-84.397...| 39|003|01074015|39003|      Allen|        Allen County| 06| H1|G4020| 338|30620|    |   A|1042470093|11266164|+40.7716274|-084.1061032|\n|POLYGON ((-82.449...| 13|189|00348794|13189|   McDuffie|     McDuffie County| 06| H1|G4020|    |12260|    |   A| 666816637|23116292|+33.4824637|-082.4731880|\n|POLYGON ((-90.191...| 55|111|01581115|55111|       Sauk|         Sauk County| 06| H1|G4020| 357|12660|    |   A|2152007753|45296336|+43.4279976|-089.9433290|\n|POLYGON ((-92.415...| 05|137|00069902|05137|      Stone|        Stone County| 06| H1|G4020|    |     |    |   A|1570579427| 7841929|+35.8570312|-092.1405728|\n|POLYGON ((-117.74...| 41|063|01155135|41063|    Wallowa|      Wallowa County| 06| H1|G4020|    |     |    |   A|8148602810|14199330|+45.5937530|-117.1855796|\n|POLYGON ((-80.518...| 42|007|01214112|42007|     Beaver|       Beaver County| 06| H1|G4020| 430|38300|    |   A|1125901160|24165972|+40.6841401|-080.3507209|\n+--------------------+---+---+--------+-----+-----------+--------------------+---+---+-----+----+-----+----+----+----------+--------+-----------+------------+\nonly showing top 20 rows\n\npolygondf_wkb: org.apache.spark.sql.DataFrame = [geometry: string, _c1: string ... 16 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=123","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=123","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=124","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=124"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572827665673_-658340266","id":"20191104-003425_268773188","dateCreated":"2019-11-04T00:34:25+0000","dateStarted":"2019-11-04T01:36:39+0000","dateFinished":"2019-11-04T01:36:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168242"},{"text":"// Optional: Use DF to manipulate RDD\n// GeoSpark provides an Adapter class\nval polygondf_wkt = Adapter.toDf(polygonrdd_wkt, spark)\npolygondf_wkt.createOrReplaceTempView(\"county_wkt\")\npolygondf_wkt.show","user":"anonymous","dateUpdated":"2019-11-04T01:36:40+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---+---+--------+-----+-----------+--------------------+---+---+-----+----+-----+----+----+----------+--------+-----------+------------+\n|            geometry|_c1|_c2|     _c3|  _c4|        _c5|                 _c6|_c7|_c8|  _c9|_c10| _c11|_c12|_c13|      _c14|    _c15|       _c16|        _c17|\n+--------------------+---+---+--------+-----+-----------+--------------------+---+---+-----+----+-----+----+----+----------+--------+-----------+------------+\n|POLYGON ((-97.019...| 31|039|00835841|31039|     Cuming|       Cuming County| 06| H1|G4020|    |     |    |   A|1477895811|10447360|+41.9158651|-096.7885168|\n|POLYGON ((-123.43...| 53|069|01513275|53069|  Wahkiakum|    Wahkiakum County| 06| H1|G4020|    |     |    |   A| 682138871|61658258|+46.2946377|-123.4244583|\n|POLYGON ((-104.56...| 35|011|00933054|35011|    De Baca|      De Baca County| 06| H1|G4020|    |     |    |   A|6015539696|29159492|+34.3592729|-104.3686961|\n|POLYGON ((-96.910...| 31|109|00835876|31109|  Lancaster|    Lancaster County| 06| H1|G4020| 339|30700|    |   A|2169240202|22877180|+40.7835474|-096.6886584|\n|POLYGON ((-98.273...| 31|129|00835886|31129|   Nuckolls|     Nuckolls County| 06| H1|G4020|    |     |    |   A|1489645187| 1718484|+40.1764918|-098.0468422|\n|POLYGON ((-65.910...| 72|085|01804523|72085|Las Piedras|Las Piedras Munic...| 13| H1|G4020| 490|41980|    |   A|  87748363|   32509|+18.1871483|-065.8711890|\n|POLYGON ((-97.129...| 46|099|01265772|46099|  Minnehaha|    Minnehaha County| 06| H1|G4020|    |43620|    |   A|2090540341|17349847|+43.6674723|-096.7957261|\n|POLYGON ((-99.821...| 48|327|01383949|48327|     Menard|       Menard County| 06| H1|G4020|    |     |    |   A|2336245914|  613559|+30.8843655|-099.8539896|\n|POLYGON ((-120.65...| 06|091|00277310|06091|     Sierra|       Sierra County| 06| H1|G4020|    |     |    |   A|2468686374|23299110|+39.5769252|-120.5219926|\n|POLYGON ((-85.239...| 21|053|00516873|21053|    Clinton|      Clinton County| 06| H1|G4020|    |     |    |   A| 510864252|21164150|+36.7288647|-085.1534262|\n|POLYGON ((-83.880...| 39|063|01074044|39063|    Hancock|      Hancock County| 06| H1|G4020| 248|22300|    |   A|1376210232| 5959837|+41.0004711|-083.6660335|\n|POLYGON ((-102.08...| 48|189|01383880|48189|       Hale|         Hale County| 06| H1|G4020|    |38380|    |   A|2602115649|  246678|+34.0684364|-101.8228879|\n|POLYGON ((-85.978...| 01|027|00161539|01027|       Clay|         Clay County| 06| H1|G4020|    |     |    |   A|1564252367| 5284573|+33.2703999|-085.8635254|\n|POLYGON ((-101.62...| 48|011|01383791|48011|  Armstrong|    Armstrong County| 06| H1|G4020| 108|11100|    |   A|2354581764|12219587|+34.9641790|-101.3566363|\n|POLYGON ((-84.397...| 39|003|01074015|39003|      Allen|        Allen County| 06| H1|G4020| 338|30620|    |   A|1042470093|11266164|+40.7716274|-084.1061032|\n|POLYGON ((-82.449...| 13|189|00348794|13189|   McDuffie|     McDuffie County| 06| H1|G4020|    |12260|    |   A| 666816637|23116292|+33.4824637|-082.4731880|\n|POLYGON ((-90.191...| 55|111|01581115|55111|       Sauk|         Sauk County| 06| H1|G4020| 357|12660|    |   A|2152007753|45296336|+43.4279976|-089.9433290|\n|POLYGON ((-92.415...| 05|137|00069902|05137|      Stone|        Stone County| 06| H1|G4020|    |     |    |   A|1570579427| 7841929|+35.8570312|-092.1405728|\n|POLYGON ((-117.74...| 41|063|01155135|41063|    Wallowa|      Wallowa County| 06| H1|G4020|    |     |    |   A|8148602810|14199330|+45.5937530|-117.1855796|\n|POLYGON ((-80.518...| 42|007|01214112|42007|     Beaver|       Beaver County| 06| H1|G4020| 430|38300|    |   A|1125901160|24165972|+40.6841401|-080.3507209|\n+--------------------+---+---+--------+-----+-----------+--------------------+---+---+-----+----+-----+----+----+----------+--------+-----------+------------+\nonly showing top 20 rows\n\npolygondf_wkt: org.apache.spark.sql.DataFrame = [geometry: string, _c1: string ... 16 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=125","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=125","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=126","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=126"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572827778137_207493657","id":"20191104-003618_283768212","dateCreated":"2019-11-04T00:36:18+0000","dateStarted":"2019-11-04T01:36:40+0000","dateFinished":"2019-11-04T01:36:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168243"},{"text":"// Build a spatial index\n// Build a quad-tree index for pointrdd\npointrdd.buildIndex(IndexType.RTREE, false)\nprintln(pointrdd.indexedRawRDD.count())","user":"anonymous","dateUpdated":"2019-11-04T01:36:41+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=127","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=127"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572827823057_1898234302","id":"20191104-003703_1839731969","dateCreated":"2019-11-04T00:37:03+0000","dateStarted":"2019-11-04T01:36:41+0000","dateFinished":"2019-11-04T01:36:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168244"},{"text":"// Build a spatial index\n// Build a r-tree index for polygonrdd_wkb\npolygonrdd_wkb.buildIndex(IndexType.QUADTREE, false)\nprintln(polygonrdd_wkb.indexedRawRDD.count())","user":"anonymous","dateUpdated":"2019-11-04T01:36:42+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=128","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=128"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572828233161_-1563630070","id":"20191104-004353_403182101","dateCreated":"2019-11-04T00:43:53+0000","dateStarted":"2019-11-04T01:36:42+0000","dateFinished":"2019-11-04T01:36:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168245"},{"text":"// Build a spatial index\n// Build a quad-tree index for polygonrdd_wkb\npolygonrdd_wkt.buildIndex(IndexType.RTREE, false)\nprintln(polygonrdd_wkt.indexedRawRDD.count())","user":"anonymous","dateUpdated":"2019-11-04T01:36:42+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=129","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=129"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572828324313_-1258714734","id":"20191104-004524_832918411","dateCreated":"2019-11-04T00:45:24+0000","dateStarted":"2019-11-04T01:36:42+0000","dateFinished":"2019-11-04T01:36:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168246"},{"text":"// Spatial range query\n// Find landmarks within Birmingham City\nval queryWindow = new Envelope(-87.111257, -86.554093, 33.339587, 33.645426)\nval queryResultRdd = RangeQuery.SpatialRangeQuery(pointrdd, queryWindow, false, true)\nprintln(queryResultRdd.count())\n\n// We can check Spark web ui to see the detailed run time","user":"anonymous","dateUpdated":"2019-11-04T01:36:43+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"115\nqueryWindow: com.vividsolutions.jts.geom.Envelope = Env[-87.111257 : -86.554093, 33.339587 : 33.645426]\nqueryResultRdd: org.apache.spark.api.java.JavaRDD[com.vividsolutions.jts.geom.Point] = MapPartitionsRDD[418] at mapPartitions at RangeQuery.java:62\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=130","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=130"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572828419454_1100154523","id":"20191104-004659_1255204775","dateCreated":"2019-11-04T00:46:59+0000","dateStarted":"2019-11-04T01:36:43+0000","dateFinished":"2019-11-04T01:36:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168247"},{"text":"// Spatial range query\n// Cache the built index and use it many times\nval queryWindow = new Envelope(-87.111257, -86.554093, 33.339587, 33.645426)\n\npointrdd.indexedRawRDD.cache()\n\nval queryResultRdd_2 = RangeQuery.SpatialRangeQuery(pointrdd, queryWindow, false, true)\nprintln(queryResultRdd_2.count())\n\nval queryResultRdd_3 = RangeQuery.SpatialRangeQuery(pointrdd, queryWindow, false, true)\nprintln(queryResultRdd_3.count())\n\n// We can check Spark web ui to see the detailed run time","user":"anonymous","dateUpdated":"2019-11-04T01:36:44+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"115\n115\nqueryWindow: com.vividsolutions.jts.geom.Envelope = Env[-87.111257 : -86.554093, 33.339587 : 33.645426]\nqueryResultRdd_2: org.apache.spark.api.java.JavaRDD[com.vividsolutions.jts.geom.Point] = MapPartitionsRDD[419] at mapPartitions at RangeQuery.java:62\nqueryResultRdd_3: org.apache.spark.api.java.JavaRDD[com.vividsolutions.jts.geom.Point] = MapPartitionsRDD[420] at mapPartitions at RangeQuery.java:62\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=131","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=131","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=132","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=132"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572828549967_-429321470","id":"20191104-004909_1464852997","dateCreated":"2019-11-04T00:49:09+0000","dateStarted":"2019-11-04T01:36:44+0000","dateFinished":"2019-11-04T01:36:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168248"},{"text":"// Spatial K Nearest Neighbor Query\n// Coordinate of Chicago (lon, lat): -87.637437, 41.888812\n\n// Create a query point\nval fact = new GeometryFactory()\nval chicago = fact.createPoint(new Coordinate(-87.637437, 41.888812))\nval queryResultList = KNNQuery.SpatialKnnQuery(pointrdd, chicago, 5, true)\nprintln(queryResultList)","user":"anonymous","dateUpdated":"2019-11-04T01:36:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[POINT (-87.636686 41.896596), POINT (-87.639603 41.878045), POINT (-87.628749 41.881699), POINT (-87.626005 41.892693), POINT (-87.626236 41.882401)]\nfact: com.vividsolutions.jts.geom.GeometryFactory = com.vividsolutions.jts.geom.GeometryFactory@5a1826d3\nchicago: com.vividsolutions.jts.geom.Point = POINT (-87.637437 41.888812)\nqueryResultList: java.util.List[com.vividsolutions.jts.geom.Point] = [POINT (-87.636686 41.896596), POINT (-87.639603 41.878045), POINT (-87.628749 41.881699), POINT (-87.626005 41.892693), POINT (-87.626236 41.882401)]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=133","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=133"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572828845812_1157957014","id":"20191104-005405_1334293939","dateCreated":"2019-11-04T00:54:05+0000","dateStarted":"2019-11-04T01:36:45+0000","dateFinished":"2019-11-04T01:36:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168249"},{"text":"// Remember you can alway travel between GeoSpark RDD and DataFrame API\n// Let us visualize the query result of Spatial Range Query\nval queryResult = new SpatialRDD[Point]\nqueryResult.rawSpatialRDD = queryResultRdd\nval df = Adapter.toDf(queryResult, spark)\ndf.createOrReplaceTempView(\"range_result\")\ndf.show()","user":"anonymous","dateUpdated":"2019-11-04T01:36:46+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|            geometry|\n+--------------------+\n|POINT (-86.926159...|\n|POINT (-86.795242...|\n|POINT (-86.707893...|\n|POINT (-86.751054...|\n|POINT (-86.677745...|\n|POINT (-86.784964...|\n|POINT (-86.801207...|\n|POINT (-86.789025...|\n|POINT (-86.834233...|\n|POINT (-86.94342 ...|\n|POINT (-86.9785 3...|\n|POINT (-86.825489...|\n|POINT (-86.955019...|\n|POINT (-86.953922...|\n|POINT (-86.928384...|\n|POINT (-86.961613...|\n|POINT (-86.967194...|\n|POINT (-86.950359...|\n|POINT (-86.945848...|\n|POINT (-86.952835...|\n+--------------------+\nonly showing top 20 rows\n\nqueryResult: org.datasyslab.geospark.spatialRDD.SpatialRDD[com.vividsolutions.jts.geom.Point] = org.datasyslab.geospark.spatialRDD.SpatialRDD@4004c8fa\nqueryResult.rawSpatialRDD: org.apache.spark.api.java.JavaRDD[com.vividsolutions.jts.geom.Point] = MapPartitionsRDD[418] at mapPartitions at RangeQuery.java:62\ndf: org.apache.spark.sql.DataFrame = [geometry: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=134","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=134","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=135","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=135"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572830412070_1973375664","id":"20191104-012012_986441155","dateCreated":"2019-11-04T01:20:12+0000","dateStarted":"2019-11-04T01:36:46+0000","dateFinished":"2019-11-04T01:36:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168250"},{"text":"%sql\nSELECT *\nFROM range_result","user":"anonymous","dateUpdated":"2019-11-04T01:36:47+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"geospark-zeppelin","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"geometry":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"geospark-zeppelin":{"geometry":{"name":"geometry","index":0,"aggr":"sum"}}}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"geometry\nPOINT (-86.926159 33.341197)\nPOINT (-86.795242 33.34646)\nPOINT (-86.707893 33.373596)\nPOINT (-86.751054 33.376606)\nPOINT (-86.677745 33.389966)\nPOINT (-86.784964 33.446644)\nPOINT (-86.801207 33.459679)\nPOINT (-86.789025 33.467194)\nPOINT (-86.834233 33.359969)\nPOINT (-86.94342 33.365682)\nPOINT (-86.9785 33.39208)\nPOINT (-86.825489 33.394477)\nPOINT (-86.955019 33.396549)\nPOINT (-86.953922 33.400892)\nPOINT (-86.928384 33.414737)\nPOINT (-86.961613 33.422722)\nPOINT (-86.967194 33.427968)\nPOINT (-86.950359 33.429236)\nPOINT (-86.945848 33.431365)\nPOINT (-86.952835 33.439197)\nPOINT (-86.927619 33.442408)\nPOINT (-86.994853 33.442707)\nPOINT (-86.91861 33.453947)\nPOINT (-86.863482 33.463174)\nPOINT (-86.857904 33.465638)\nPOINT (-86.907779 33.4665)\nPOINT (-86.824393 33.466513)\nPOINT (-86.849107 33.47048)\nPOINT (-86.886749 33.473079)\nPOINT (-86.909974 33.473891)\nPOINT (-86.856913 33.477542)\nPOINT (-86.91365 33.479007)\nPOINT (-86.85329 33.480548)\nPOINT (-86.90931 33.482642)\nPOINT (-86.915734 33.484088)\nPOINT (-86.822766 33.48428)\nPOINT (-86.887479 33.48474)\nPOINT (-86.794481 33.472752)\nPOINT (-86.800378 33.475037)\nPOINT (-86.769082 33.47579)\nPOINT (-86.790265 33.47907)\nPOINT (-86.783125 33.484098)\nPOINT (-86.797244 33.488753)\nPOINT (-86.774935 33.488971)\nPOINT (-86.745402 33.489928)\nPOINT (-86.799851 33.498444)\nPOINT (-86.854182 33.488135)\nPOINT (-86.969154 33.488779)\nPOINT (-86.973144 33.48894)\nPOINT (-86.876689 33.493178)\nPOINT (-86.901174 33.49355)\nPOINT (-86.822586 33.494282)\nPOINT (-86.813881 33.494937)\nPOINT (-86.869959 33.496018)\nPOINT (-86.811572 33.49738)\nPOINT (-86.899999 33.500379)\nPOINT (-86.775496 33.500939)\nPOINT (-86.77016 33.501206)\nPOINT (-86.756263 33.501213)\nPOINT (-86.787352 33.501863)\nPOINT (-86.807623 33.502595)\nPOINT (-86.784553 33.50415)\nPOINT (-86.770539 33.507469)\nPOINT (-86.780258 33.507537)\nPOINT (-86.789198 33.507947)\nPOINT (-86.77445 33.518152)\nPOINT (-86.871336 33.500903)\nPOINT (-86.881874 33.50134)\nPOINT (-86.876465 33.501841)\nPOINT (-86.834697 33.503181)\nPOINT (-86.879076 33.507319)\nPOINT (-86.846518 33.509341)\nPOINT (-86.861756 33.511826)\nPOINT (-86.814541 33.515438)\nPOINT (-86.889912 33.518942)\nPOINT (-86.811198 33.519551)\nPOINT (-86.809751 33.522224)\nPOINT (-86.847787 33.523772)\nPOINT (-86.818014 33.523828)\nPOINT (-86.850312 33.525442)\nPOINT (-86.826296 33.525889)\nPOINT (-86.850132 33.526701)\nPOINT (-86.889504 33.530144)\nPOINT (-86.874562 33.531736)\nPOINT (-86.804193 33.521872)\nPOINT (-86.757907 33.527513)\nPOINT (-86.808749 33.530715)\nPOINT (-86.807034 33.532395)\nPOINT (-86.776779 33.536222)\nPOINT (-86.707075 33.537947)\nPOINT (-86.757097 33.543754)\nPOINT (-86.733092 33.547855)\nPOINT (-86.77898 33.550309)\nPOINT (-86.750436 33.550309)\nPOINT (-86.75356 33.551036)\nPOINT (-86.77898 33.551926)\nPOINT (-86.739685 33.554167)\nPOINT (-86.750489 33.557104)\nPOINT (-86.778942 33.5579)\nPOINT (-86.780063 33.565142)\nPOINT (-86.758741 33.565205)\nPOINT (-86.728498 33.567304)\nPOINT (-86.719281 33.577392)\nPOINT (-86.717359 33.583832)\nPOINT (-86.925651 33.538283)\nPOINT (-86.888117 33.54088)\nPOINT (-86.830538 33.555539)\nPOINT (-86.917322 33.566531)\nPOINT (-86.95504 33.600631)\nPOINT (-86.917801 33.638304)\nPOINT (-86.77565 33.583859)\nPOINT (-86.642022 33.596536)\nPOINT (-86.80687 33.603407)\nPOINT (-86.799416 33.608859)\nPOINT (-86.603182 33.620322)\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=136","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=136","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=137","http://ip-172-31-14-105.ec2.internal:4040/jobs/job?id=137"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1572831214892_368758695","id":"20191104-013334_531326325","dateCreated":"2019-11-04T01:33:34+0000","dateStarted":"2019-11-04T01:36:47+0000","dateFinished":"2019-11-04T01:36:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168251"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2019-11-04T01:36:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1572831319249_-579693755","id":"20191104-013519_1454532825","dateCreated":"2019-11-04T01:35:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168252"}],"name":"GeoSpark_Tutorial/2_RDD","id":"2ETRKRPQV","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}